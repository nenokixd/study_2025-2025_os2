---
# Preamble

## Author
author:
  name: Чекмарев Александр Дмитриевич | группа НПИбд 03-24
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
   
## Title
title: "Лабораторная работа №2"
subtitle: "Управление пользователями и группами"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Получить представление о работе с учётными записями пользователей и группами пользователей в операционной системе типа Linux.

# Выполнение лабораторной работы

##  Переключение учётных записей пользователей

Войдем в систему как обычный пользователь и откроем терминал
Определим какую учётную запись пользователя мы используем, введя команду whoami

![Команда whoami](image/Screenshot_1.png)

Выведем на экран более подробную информацию, используя команду id

![Подробная информация пользователя](image/Screenshot_2.png){#fig:001 width=100%}

Используем команду su для переключения к учётной записи root. Снова используем команду id

![Подробная информация пользователя root](image/Screenshot_3.png){#fig:001 width=100%}

Вернемся к своей учётной записи.
Просмотрим в безопасном режиме файл /etc/sudoers с помощью команды sudo -i visudo

![Демонстрация использования команды](image/Screenshot_4.png){#fig:001 width=100%}

Открываемый visudo редактор можно указать любой. Например, если требуется использовать mcedit, то в терминале для запуска visudo можно указать: sudo -i EDITOR=mcedit visudo
Но все же следует использовать visudo. Так как visudo гарантирует корректность, безопасность изменений и проверяет синтаксис, чего обычный редактор не обеспечивает.

![Демонстрация использования команды](image/Screenshot_6.png)

Убедимся, что в открытом с помощью visudo файле присутствует строка %wheel ALL=(ALL) ALL
Wheel - это специальная системная группа пользователей. Только пользователи, входящие в группу wheel, имеют право выполнять команды через sudo

![Фрагмент файла](image/Screenshot_5.png)

Создадим пользователя alice, входящего в группу wheel: sudo -i useradd -G wheel alice
Убедимся, что пользователь alice добавлен в группу wheel, введя id alice

![Создание пользователя и его информация](image/Screenshot_7.png)

Зададим пароль для пользователя alice, набрав sudo -i passwd alice

![Пароль alice](image/Screenshot_8.png){#fig:001 width=100%}

Переключимся на учётную запись пользователя alice: su alice
Создадим пользователя bob: sudo useradd bob

![Создание пользователя bob](image/Screenshot_9.png)

Установим пароль для пользователя bob: sudo passwd bob
Просмотрим, в какие группы входит пользователь bob: id bob

![Пароль и информация пользователя bob](image/Screenshot_10.png){#fig:001 width=100%}

## Создание учётных записей пользователей

Переключимся в терминале на учётную запись пользователя root
Откроем файл конфигурации /etc/login.defs для редактирования, используя, например, vim: vim /etc/login.defs

![Демонстрация использования команды](image/Screenshot_11.png)

Изменим несколько параметров. Например, найдем параметр CREATE_HOME и убедимся, что он установлен в значение yes. 

![Фрагмент файла](image/Screenshot_12.png)

Также установим параметр USERGROUPS_ENAB no

![Фрагмент файла](image/Screenshot_13.png)

Это позволит не добавлять нового пользователя в группу с тем же именем, что и пользователь, а использовать группу users.


Перейдем в каталог /etc/skel: cd /etc/skel
Создадим каталоги Pictures и Documents 

![Создание каталогов](image/Screenshot_14.png)

Это позволит добавить эти каталоги по умолчанию во все домашние каталоги пользователей.

Изменим содержимое файла .bashrc, добавив строку export EDITOR=/usr/bin/vim или export EDITOR=/usr/bin/mceditor
Эта запись означает, что текстовый редактор vim или редактор mceditor будет установлен по умолчанию для инструментов, которые нуждаются в изменении текстовых файлов

![Изменение файла](image/Screenshot_15.png)

Переключимся в терминале на учётную запись пользователя alice: su alice
Используем утилиту useradd, создадим пользователя carol: sudo -i useradd carol
Установим пароль для пользователя carol: sudo passwd carol

![Создание пользователя с паролем](image/Screenshot_16.png)

Посмотрим информацию о пользователе carol.
Также убедимся, что каталоги Pictures и Documents были созданы в домашнем каталоге пользователя carol

![Информация пользователя и просмотр каталогов](image/Screenshot_17.png)

Переключимся в терминале на учётную запись пользователя alice: su alice
Просмотрим строку записи о пароле пользователя carol в файле /etc/shadow

![Вывод с информацией о пароле пользователя](image/Screenshot_18.png)

В начале пишется имя пользователя. Далее зашифрованный пароль. Дата смены пароля.
Минимально число дней между сменами. Максмиальное число дней действия пароля. Дней до предупреждения об окончании срока действия.

Изменим свойства пароля пользователя carol следующим образом: sudo passwd -n 30 -w 3 -x 90 carol
Убедимся в изменении.

![Изменения свойств пароля](image/Screenshot_19.png)

В этой записи срок действия пароля истекает через 90 дней (-x 90). За три дня до истечения срока действия пользователь получит предупреждение (-w 3). 
Пароль должен использоваться как минимум за 30 дней (-n 30) до того, как его можно будет изменить.


Убедимся, что идентификатор alice существует во всех трёх файлах

![Просмотр информации пользователя alice](image/Screenshot_20.png)

Убедимся, что идентификатор carol существует не во всех трёх файлах

![Просмотр информации пользователя carol](image/Screenshot_21.png)


## Работа с группами

Находясь под учётной записью пользователя alice, создадим группы main и third:
sudo groupadd main
sudo groupadd third

![Создание групп](image/Screenshot_22.png)

Используем usermod для добавления пользователей alice и bob в группу main, а carol — в группу third:
sudo usermod -aG main alice
sudo usermod -aG main bob
sudo usermod -aG third carol

![Добавление пользователей в группы](image/Screenshot_23.png)

Убедимся, что пользователь carol правильно добавлен в группу third

![Информация о пользователе carol](image/Screenshot_24.png)

Определим участников каких групп являются другие созданные нами пользователи

![Информация о других пользователях](image/Screenshot_25.png)



# Контрольные вопросы

1. При помощи каких команд можно получить информацию о номере (идентификаторе), назначенном пользователю Linux, о группах, в которые включён пользователь?

id (имя пользователя) - UID, GID, список групп 
groups (имя пользователя) — только список групп
getent passwd (имя пользователя) — UID и GID из базы учётных записей

2. Какой UID имеет пользователь root? При помощи какой команды можно узнать UID пользователя? Приведите примеры.

У root пользователя всегда uid = 0

![Пример с id](image/Screenshot_26.png)

![Пример с getent passwd](image/Screenshot_27.png)

3. В чём состоит различие между командами su и sudo?

su — переключает пользователя (по умолчанию в root), требуется пароль root.
sudo — выполняет отдельную команду от имени root (или другого пользователя), требует пароль самого пользователя, если он включён в sudoers.

4. В каком конфигурационном файле определяются параметры sudo?

В /etc/sudoers

5. Какую команду следует использовать для безопасного изменения конфигурации sudo?

sudo -i visudo

6. Если вы хотите предоставить пользователю доступ ко всем командам администрирования системы через sudo, членом какой группы он должен быть?

Группы wheel

7. Какие файлы/каталоги можно использовать для определения параметров, которые будут использоваться при создании учётных записей пользователей? Приведите примеры настроек.

/etc/default/useradd — общие параметры (например, домашний каталог по умолчанию, оболочка).

/etc/login.defs — политика паролей, UID/GID диапазоны, срок действия паролей.

/etc/skel/ — шаблон файлов, которые копируются в новый домашний каталог (например .bashrc, .profile).

8. Где хранится информация о первичной и дополнительных группах пользователей ОС типа Linux? В отчёте приведите пояснение таких записей для пользователя alice.

В /etc/passwd — указана первичная группа

![Первичная группа](image/Screenshot_28.png)

В /etc/group — содержатся дополнительные группы

![Дополнительные группы](image/Screenshot_29.png)

9. Какие команды вы можете использовать для изменения информации о пароле пользователя (например о сроке действия пароля)?

passwd <имя_пользователя> — смена пароля

chage <имя_пользователя> — управление сроком действия пароля (макс./мин. дни, дата истечения, предупреждения)

10. Какую команду следует использовать для прямого изменения информации в файле /etc/group и почему?

vigr — безопасный редактор для /etc/group (аналог visudo)

Проверяет корректность синтаксиса
Блокирует файл от одновременного редактирования

# Выводы

В ходе работы изучены основы управления учётными записями и группами пользователей в Linux.

# Список литературы{.unnumbered}

::: {#refs}
:::
